<!DOCTYPE html>
<html>
<head>
	<title>Gantt Chart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
		google.charts.load('current', {'packages':['gantt']});
		google.charts.setOnLoadCallback(drawChart);

		function drawChart() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Task ID');
			data.addColumn('string', 'Task Name');
			data.addColumn('string', 'Resource');
			data.addColumn('date', 'Start Date');
			data.addColumn('date', 'End Date');
			data.addColumn('number', 'Duration');
			data.addColumn('number', 'Percent Complete');
			data.addColumn('string', 'Dependencies');

			// Fetch data from PHP script
			$.ajax({
				url: 'fetch_tasks.php',
				dataType: 'json',
				success: function(response) {
					$.each(response, function(i, task) {
						data.addRow([
							task.task_id,
							task.task_name,
							task.resource,
							new Date(task.start_date),
							new Date(task.end_date),
							null,
							parseInt(task.percent_complete),
							task.dependencies
						]);
					});

					var options = {
						height: response.length * 40,
						gantt: {
							criticalPathEnabled: false,
							criticalPathStyle: {
								stroke: '#e64a19',
								strokeWidth: 5
							},
							barHeight: 20,
							barCornerRadius: 10,
							trackHeight: 30,
							trackGap: 0,
							defaultStartDateMillis: new Date(2023, 0, 1),
							defaultEndDateMillis: new Date(2023, 11, 31)
						}
					};

					var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
					chart.draw(data, options);
				}
			});
		}
	</script>
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-12">
				<h1>Gantt Chart</h1>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-12">
				<div id="chart_div"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-12">
				<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addModal">Add Task</button>
			</div>
		</div>
	</div>

<!-- Add Modal -->
<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addModalLabel">Add Task</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form method="POST" action="add.php">
            <div class="form-group">
              <label for="task-name" class="col-form-label">Task Name:</label>
              <input type="text" class="form-control" id="task-name" name="task-name" required>
            </div>
            <div class="form-group">
              <label for="start-date" class="col-form-label">Start Date:</label>
              <input type="date" class="form-control" id="start-date" name="start-date" required>
            </div>
            <div class="form-group">
              <label for="end-date" class="col-form-label">End Date:</label>
              <input type="date" class="form-control" id="end-date" name="end-date" required>
            </div>
            <div class="form-group">
              <label for="progress" class="col-form-label">Progress:</label>
              <input type="number" class="form-control" id="progress" name="progress" min="0" max="100" step="1" required>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Add Task</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  